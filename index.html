<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Premium Recipe Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #121212;
            color: #ffffff;
            -webkit-tap-highlight-color: transparent;
        }

        /* Safe Area for iPhone X+ */
        .safe-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Hide Scrollbar but allow scrolling */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Glassmorphism Effect */
        .glass {
            background: rgba(30, 30, 30, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Smooth Fade In */
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen bg-[#121212] text-white relative overflow-x-hidden">

    <!-- 1. 몰입형 비디오/이미지 헤더 (모바일 최적화) -->
    <div class="relative w-full h-[45vh] overflow-hidden">
        <!-- 그라데이션 오버레이 (텍스트 가독성 확보) -->
        <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-[#121212] z-10"></div>
        
        <!-- 관리자 컨트롤 (상단 고정) -->
        <div class="absolute top-0 left-0 right-0 z-20 p-6 pt-12 flex justify-between items-start">
            <button class="bg-black/30 backdrop-blur-md p-2 rounded-full border border-white/10 active:scale-95 transition-transform">
                <i data-lucide="chevron-left" class="w-6 h-6 text-white"></i>
            </button>
            <div class="flex gap-3">
                <span class="bg-emerald-500/90 backdrop-blur-md px-3 py-1 rounded-full text-xs font-bold tracking-wide shadow-lg">ADMIN TEST</span>
                <button class="bg-black/30 backdrop-blur-md p-2 rounded-full border border-white/10 active:scale-95 transition-transform">
                    <i data-lucide="share-2" class="w-5 h-5 text-white"></i>
                </button>
            </div>
        </div>

        <!-- 메인 비디오 썸네일 (이전 버전에서 안보이던 문제 해결을 위해 background-image 사용) -->
        <div class="w-full h-full bg-cover bg-center transform scale-105" 
             style="background-image: url('https://images.unsplash.com/photo-1556910103-1c02745a30bf?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');">
             <!-- Play Button Overlay -->
             <div class="absolute inset-0 z-10 flex items-center justify-center">
                <button class="group relative flex items-center justify-center">
                    <div class="absolute w-16 h-16 bg-emerald-500/30 rounded-full animate-ping"></div>
                    <div class="relative w-16 h-16 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center border border-white/20 group-active:scale-95 transition-all">
                        <i data-lucide="play" class="w-6 h-6 text-white fill-white ml-1"></i>
                    </div>
                </button>
             </div>
        </div>
    </div>

    <!-- 2. 메인 컨텐츠 (바텀 시트 스타일) -->
    <main class="relative z-20 -mt-10 px-6 pb-40">
        <!-- 타이틀 섹션 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.1s;">
            <div class="flex items-center gap-2 mb-2">
                <span class="text-emerald-400 text-sm font-semibold tracking-wider">ITALIAN RECIPE</span>
                <div class="h-1 w-1 rounded-full bg-gray-500"></div>
                <span class="text-gray-400 text-sm">20 min</span>
            </div>
            <h1 class="text-3xl font-bold leading-tight mb-4">클래식 바질 페스토 파스타<br><span class="text-gray-500 text-xl font-normal">Chef. Gordon Style</span></h1>
            
            <div class="flex items-center justify-between p-4 bg-[#1E1E1E] rounded-2xl border border-white/5">
                <div class="text-center">
                    <span class="block text-gray-400 text-xs mb-1">난이도</span>
                    <span class="font-medium">중급</span>
                </div>
                <div class="w-px h-8 bg-white/10"></div>
                <div class="text-center">
                    <span class="block text-gray-400 text-xs mb-1">총 비용</span>
                    <span class="font-medium text-emerald-400">42,500원</span>
                </div>
                <div class="w-px h-8 bg-white/10"></div>
                <div class="text-center">
                    <span class="block text-gray-400 text-xs mb-1">칼로리</span>
                    <span class="font-medium">580 kcal</span>
                </div>
            </div>
        </div>

        <!-- 재료 섹션 헤더 -->
        <div class="flex items-end justify-between mb-5 fade-in" style="animation-delay: 0.2s;">
            <h2 class="text-xl font-bold">필요한 재료 <span class="text-emerald-500 ml-1">5</span></h2>
            <button class="text-xs text-gray-500 flex items-center gap-1 active:text-emerald-400">
                링크 점검 <i data-lucide="check-circle-2" class="w-3 h-3"></i>
            </button>
        </div>

        <!-- 재료 리스트 (카드형) -->
        <div id="ingredient-list" class="space-y-3 fade-in" style="animation-delay: 0.3s;">
            <!-- JS로 렌더링됨 -->
        </div>

        <!-- 여백 (하단 버튼 가림 방지) -->
        <div class="h-12"></div>
    </main>

    <!-- 3. 플로팅 바텀 액션 바 (Glassmorphism) -->
    <div class="fixed bottom-0 left-0 right-0 z-50 glass safe-bottom">
        <div class="px-6 py-4">
            <div class="flex gap-3 items-center">
                <!-- 장바구니 상태/초기화 -->
                <div class="flex-shrink-0 relative">
                    <button onclick="resetCart()" class="w-14 h-14 bg-[#2A2A2A] rounded-2xl flex items-center justify-center text-gray-400 border border-white/5 active:bg-[#333] transition-colors">
                        <i data-lucide="rotate-ccw" class="w-6 h-6"></i>
                    </button>
                    <!-- 뱃지 (선택된 개수) -->
                    <span id="cart-count" class="absolute -top-1 -right-1 w-5 h-5 bg-emerald-500 rounded-full text-[10px] font-bold flex items-center justify-center hidden">0</span>
                </div>

                <!-- 전체 담기 버튼 -->
                <button onclick="addAllToCart()" class="flex-1 h-14 bg-emerald-600 hover:bg-emerald-500 rounded-2xl flex items-center justify-center gap-2 text-white font-bold text-lg shadow-lg shadow-emerald-900/40 active:scale-[0.98] transition-all">
                    <span id="main-btn-text">모든 재료 담기</span>
                    <span class="w-px h-4 bg-white/20 mx-1"></span>
                    <span id="total-price" class="font-medium">0원</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-24 left-1/2 transform -translate-x-1/2 z-[100] flex items-center gap-3 bg-[#1E1E1E]/95 backdrop-blur border border-white/10 px-5 py-3 rounded-full shadow-2xl opacity-0 pointer-events-none transition-all duration-300 translate-y-4">
        <div class="bg-emerald-500/20 p-1.5 rounded-full">
            <i data-lucide="check" class="w-4 h-4 text-emerald-500"></i>
        </div>
        <p id="toast-msg" class="text-sm font-medium text-white">장바구니에 담겼습니다.</p>
    </div>

    <script>
        // 데이터
        const ingredients = [
            { id: 1, name: "엑스트라 버진 올리브오일", brand: "De Cecco", price: 18500, img: "https://images.unsplash.com/photo-1474979266404-7cadd9385a53?auto=format&fit=crop&w=200&h=200&q=80" },
            { id: 2, name: "프레시 생바질", brand: "팜프레시", price: 4200, img: "https://images.unsplash.com/photo-1620916297397-a4a5402a3c6c?auto=format&fit=crop&w=200&h=200&q=80" },
            { id: 3, name: "파르미지아노 레지아노", brand: "Zanetti", price: 12800, img: "https://images.unsplash.com/photo-1632340603655-85d581494086?auto=format&fit=crop&w=200&h=200&q=80" },
            { id: 4, name: "국내산 통마늘", brand: "농협", price: 3500, img: "https://images.unsplash.com/photo-1615485290382-441e4d049cb5?auto=format&fit=crop&w=200&h=200&q=80" },
            { id: 5, name: "스파게티 면 No.12", brand: "De Cecco", price: 3500, img: "https://images.unsplash.com/photo-1595855728531-049750a63332?auto=format&fit=crop&w=200&h=200&q=80" }
        ];

        let cart = new Set();

        function render() {
            const container = document.getElementById('ingredient-list');
            container.innerHTML = '';
            let total = 0;

            ingredients.forEach(item => {
                const isSelected = cart.has(item.id);
                if(isSelected) total += item.price;

                const cardStyle = isSelected 
                    ? 'bg-[#1E1E1E] border-emerald-500/50 ring-1 ring-emerald-500/30' 
                    : 'bg-[#1E1E1E] border-white/5';
                
                const btnStyle = isSelected
                    ? 'bg-emerald-500 text-white border-emerald-500'
                    : 'bg-[#2A2A2A] text-gray-400 border-white/5';

                container.innerHTML += `
                <div class="flex items-center p-3 rounded-2xl border ${cardStyle} transition-all duration-300 active:scale-[0.99]">
                    <!-- 이미지 -->
                    <div class="relative w-16 h-16 rounded-xl overflow-hidden bg-[#2A2A2A] flex-shrink-0">
                        <img src="${item.img}" class="w-full h-full object-cover" alt="${item.name}">
                    </div>
                    
                    <!-- 텍스트 -->
                    <div class="flex-1 ml-4 mr-2 min-w-0">
                        <div class="text-xs text-gray-500 mb-0.5">${item.brand}</div>
                        <h3 class="font-medium text-white truncate text-[15px] mb-1">${item.name}</h3>
                        <div class="flex items-center gap-2">
                            <span class="text-sm font-bold text-emerald-400">${item.price.toLocaleString()}원</span>
                            <a href="#" class="text-[10px] text-gray-500 underline decoration-gray-600">쿠팡보기</a>
                        </div>
                    </div>

                    <!-- 개별 버튼 -->
                    <button onclick="toggle(${item.id})" class="w-10 h-10 rounded-xl flex items-center justify-center border ${btnStyle} transition-all active:scale-90">
                        <i data-lucide="${isSelected ? 'check' : 'plus'}" class="w-5 h-5"></i>
                    </button>
                </div>
                `;
            });

            // 하단바 업데이트
            const countBadge = document.getElementById('cart-count');
            if(cart.size > 0) {
                countBadge.innerText = cart.size;
                countBadge.classList.remove('hidden');
                document.getElementById('main-btn-text').innerText = cart.size === ingredients.length ? "구매하러 가기" : "나머지 모두 담기";
            } else {
                countBadge.classList.add('hidden');
                document.getElementById('main-btn-text').innerText = "모든 재료 담기";
                // 전체 합계 계산 (선택 안했을 땐 전체 가격 보여주기)
                total = ingredients.reduce((acc, cur) => acc + cur.price, 0);
            }
            
            document.getElementById('total-price').innerText = total.toLocaleString() + "원";
            lucide.createIcons();
        }

        function toggle(id) {
            if(cart.has(id)) {
                cart.delete(id);
                showToast('장바구니에서 뺐습니다.');
            } else {
                cart.add(id);
                showToast('장바구니에 담았습니다.');
            }
            render();
        }

        function addAllToCart() {
            if(cart.size === ingredients.length) {
                // 이미 다 담겼으면 결제 페이지 로직 등 (여기선 토스트만)
                showToast('이미 모든 재료가 담겨있습니다.');
                return;
            }
            ingredients.forEach(i => cart.add(i.id));
            render();
            showToast('모든 재료를 담았습니다!');
        }

        function resetCart() {
            if(cart.size === 0) return;
            cart.clear();
            render();
            showToast('초기화되었습니다.');
        }

        let toastTimer;
        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            
            toast.classList.remove('opacity-0', 'translate-y-4');
            
            clearTimeout(toastTimer);
            toastTimer = setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-4');
            }, 2000);
        }

        // 초기실행
        render();
        lucide.createIcons();
    </script>
</body>
</html>
